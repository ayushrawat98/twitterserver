import{a as T}from"./chunk-RHFBXMIA.js";import{b as S,c as M}from"./chunk-33Y4DNJU.js";import{B as a,C as c,G as m,H as x,J as d,M as o,N as s,O as P,P as h,Q as u,R as _,W as f,_ as g,g as v,p as C,t as l,u as p,wa as b}from"./chunk-KVUTPX5S.js";function O(i,e){if(i&1){let t=h();o(0,"app-textarea",5),u("sendText",function(r){l(t);let A=_();return p(A.add(r))}),s()}}function I(i,e){i&1&&(o(0,"p",2),f(1,"Login to post"),s())}function V(i,e){if(i&1){let t=h();o(0,"button",6),u("click",function(){l(t);let r=_();return p(r.loadOlder())}),f(1,"Load Older"),s()}}var w=class i{constructor(e,t){this._postservice=e;this._authservice=t}allPosts=[];hideLoadMore=!1;ngOnInit(){this._postservice.mainCache.post.length!=0?this.allPosts=this._postservice.mainCache.post:this.getAllPosts()}getAllPosts(){this._postservice.getAllPosts().subscribe({next:e=>{e.length!=0?(this.allPosts.push(...e),this._postservice.mainCache.post.push(...e)):(this._postservice.mainCache.pageno--,this.hideLoadMore=!0)}})}add(e){let t=this._authservice.userdata()?.id??0;t!=0&&this._postservice.addNewPost({content:e.content,id:t,parentpostid:null,file:e.file}).pipe(v(1e3)).subscribe({next:n=>{this.getAllPosts(),this._postservice.postSuccessSubject.next(1)},error:n=>{alert(n.error),this._postservice.postSuccessSubject.next(-1)}})}loadOlder(){this._postservice.mainCache.pageno++,this.getAllPosts()}static \u0275fac=function(t){return new(t||i)(c(M),c(b))};static \u0275cmp=C({type:i,selectors:[["app-main"]],standalone:!0,features:[g],decls:5,vars:4,consts:[[1,"container"],["placeholderText","What is happening?"],[1,"text-area-p"],[3,"list","showSeperator"],[1,"center-block"],["placeholderText","What is happening?",3,"sendText"],[1,"center-block",3,"click"]],template:function(t,n){t&1&&(o(0,"div",0),m(1,O,1,0,"app-textarea",1)(2,I,2,0,"p",2),P(3,"app-postlist",3),m(4,V,2,0,"button",4),s()),t&2&&(a(),d(n._authservice.userdata()?1:2),a(2),x("list",n.allPosts)("showSeperator",!1),a(),d(n.hideLoadMore?-1:4))},dependencies:[S,T]})};export{w as MainComponent};
