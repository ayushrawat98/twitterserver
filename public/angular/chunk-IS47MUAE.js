import{a as T}from"./chunk-GYFRJGPP.js";import{a as x,b as w}from"./chunk-MZ7H3CGF.js";import{B as s,Ba as C,C as l,G as v,H as a,J as u,M as n,N as r,O as f,P,Q as p,R as c,W as d,_ as S,p as _,pa as g,t as b,u as h}from"./chunk-MLTJO6UL.js";function N(t,i){if(t&1){let e=P();n(0,"app-textarea",7),p("sendText",function(m){b(e);let M=c();return h(M.add(m))}),r()}if(t&2){let e=c();a("disablePostButton",e.disablePostButton)}}function O(t,i){t&1&&(n(0,"p",2),d(1,"Login to post"),r())}function A(t,i){t&1&&f(0,"div",3)}function B(t,i){if(t&1&&f(0,"app-postlist",4),t&2){let e=c();a("list",e.allPosts)("showSeperator",!1)}}var y=class t{constructor(i,e,o){this._postService=i;this._authService=e;this.viewportScroller=o}allPosts=[];pageNumber=0;disablePostButton=!1;loading=!1;ngOnInit(){this.getAllPosts()}getAllPosts(){this.loading=!0,this._postService.getAllPosts(this._authService.userdata()?.id??null,this.pageNumber).subscribe({next:i=>{this.allPosts=i,this.viewportScroller.scrollToPosition([0,0]),this.loading=!1}})}add(i){this.disablePostButton=!0,this._postService.addNewPost({content:i.content,parentpostid:null,file:i.file}).pipe().subscribe({next:e=>{this.pageNumber=0,this.getAllPosts(),this.disablePostButton=!1,this._postService.postSuccessSubject.next("success")},error:e=>{alert(e.error),this.disablePostButton=!1,this._postService.postSuccessSubject.next("fail")}})}loadNew(){this.pageNumber--,this.getAllPosts()}loadOld(){this.pageNumber++,this.getAllPosts()}ngOnDestroy(){}static \u0275fac=function(e){return new(e||t)(l(x),l(C),l(g))};static \u0275cmp=_({type:t,selectors:[["app-main"]],standalone:!0,features:[S],decls:10,vars:4,consts:[[1,"container"],["placeholderText","What is happening?",3,"disablePostButton"],[1,"text-area-p"],[1,"spinner","center-block"],[3,"list","showSeperator"],[2,"display","flex","justify-content","space-between"],[3,"click","disabled"],["placeholderText","What is happening?",3,"sendText","disablePostButton"]],template:function(e,o){e&1&&(n(0,"div",0),v(1,N,1,1,"app-textarea",1)(2,O,2,0,"p",2)(3,A,1,0,"div",3)(4,B,1,2,"app-postlist",4),n(5,"div",5)(6,"button",6),p("click",function(){return o.loadNew()}),d(7,"Load New"),r(),n(8,"button",6),p("click",function(){return o.loadOld()}),d(9,"Load Older"),r()()()),e&2&&(s(),u(o._authService.userdata()?1:2),s(2),u(o.loading?3:4),s(3),a("disabled",o.pageNumber==0),s(2),a("disabled",o.allPosts[o.allPosts.length-1]&&o.allPosts[o.allPosts.length-1].id==1))},dependencies:[w,T],styles:["button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:auto}"]})};export{y as MainComponent};
