import{A as L,B as r,C as _,D as R,Da as Q,G as C,Ga as M,H as c,Ha as W,J as f,K as N,L as $,M as l,N as s,O as d,P as v,Q as k,R as a,W as p,X as x,Y as h,a as P,ba as I,c as T,ea as U,ga as B,ia as H,j as F,m as z,na as Y,o as w,pa as Z,q as j,ra as q,s as m,t as u,ta as G,va as J,w as y,x as g,y as A,z as S,za as K}from"./chunk-K4OJKT4O.js";var O=class i{constructor(t){this.http=t}postSuccessSubject=new T;baseUrl=M.baseUrl;getAllPosts(t,e){return this.http.get(this.baseUrl+"/api/post?page="+e)}getAllUserPosts(t,e){return this.http.get(`${this.baseUrl}/api/post/${t}/posts`)}getPostById(t,e,n){return this.http.get(`${this.baseUrl}/api/post/${e}`)}addNewPost(t){let e=new FormData;return e.append("content",t.content),e.append("parentpostid",t.parentpostid?.toString()??""),t.file&&e.append("file",t.file),this.http.post(this.baseUrl+"/api/post",e)}likePost(t,e,n){return this.http.post(this.baseUrl+"/api/post/like",{userid:t,postid:e,receiverid:n})}Repost(t,e,n){return this.http.post(this.baseUrl+"/api/post/repost",{userid:t,postid:e,receiverid:n})}Bookmark(t,e,n){return this.http.post(this.baseUrl+"/api/post/bookmark",{userid:t,postid:e,receiverid:n})}static \u0275fac=function(e){return new(e||i)(z(J))};static \u0275prov=F({token:i,factory:i.\u0275fac,providedIn:"root"})};var ie=(i,t)=>({"bi-heart-fill red":i,"bi-heart":t}),ne=(i,t)=>({green:i,"":t}),oe=(i,t)=>({"bi-bookmark-fill blue":i,"bi-bookmark":t});function re(i,t){if(i&1){let e=v();l(0,"button",7),k("click",function(o){m(e);let b=a(3);return b.showIframe=!0,u(o.stopPropagation())}),p(1,"Embed Video"),s()}}function se(i,t){if(i&1&&d(0,"iframe",11),i&2){let e=a(3);c("src",e.youtubeUrl(),L)}}function ae(i,t){if(i&1&&C(0,re,2,0,"button")(1,se,1,1,"iframe",11),i&2){let e=a(2);f(e.showIframe?1:0)}}function le(i,t){if(i&1&&d(0,"video",12),i&2){let e=a(3);c("src",e.baseUrl+"/"+e.post().media,S)}}function pe(i,t){if(i&1&&d(0,"img",13),i&2){let e=a(3);c("src",e.baseUrl+"/"+e.post().media,S)}}function ce(i,t){if(i&1&&C(0,le,1,1,"video",12)(1,pe,1,1,"img",13),i&2){let e=a(2);f(e.post().mediatype=="video/mp4"||e.post().mediatype=="video/webm"?0:1)}}function de(i,t){if(i&1){let e=v();l(0,"article")(1,"aside"),d(2,"img",0),s(),l(3,"div",1)(4,"header")(5,"span",2),p(6),s(),p(7," \xA0 "),l(8,"span",3),p(9),s(),p(10," \xA0 "),l(11,"span",4),p(12),B(13,"date"),s()(),l(14,"section",2)(15,"p"),p(16),s(),C(17,ae,2,1)(18,ce,2,1),s(),l(19,"footer",5)(20,"div",2),d(21,"i",6),p(22),s(),l(23,"div",7),k("click",function(){m(e);let o=a();return u(o.likeClicked.emit(o.post().id))}),d(24,"i",8),p(25),s(),l(26,"div",7),k("click",function(){m(e);let o=a();return u(o.repostClicked.emit(o.post().id))}),d(27,"i",9),p(28),s(),l(29,"div"),d(30,"i",10),p(31),s(),l(32,"div",7),k("click",function(){m(e);let o=a();return u(o.bookmarkClicked.emit(o.post().id))}),d(33,"i",8),p(34),s()()()()}if(i&2){let e=a();r(2),c("src",e.post().User.profilepicture?e.baseUrl+"/"+e.post().User.profilepicture:"default.png",S)("routerLink","/"+e.post().User.username),r(3),c("routerLink","/"+e.post().User.username),r(),x(e.post().User.displayname),r(2),c("routerLink","/"+e.post().User.username),r(),x("@"+e.post().User.username),r(3),x(H(13,20,e.post().createdAt,"d/M/YY, h:mm a")),r(2),c("routerLink","/"+e.post().User.username+"/post/"+e.post().id),r(2),x(e.post().content),r(),f(e.youtubeUrl()?17:-1),r(),f(e.post().media?18:-1),r(2),c("routerLink","/"+e.post().User.username+"/post/"+e.post().id),r(2),h(" ",e.post().commentcount," "),r(2),c("ngClass",U(23,ie,e.post().liked,!e.post().liked)),r(),h(" ",e.post().likecount," "),r(2),c("ngClass",U(26,ne,e.post().reposted,!e.post().reposted)),r(),h(" ",e.post().repostcount," "),r(3),h(" ",e.post().views," "),r(2),c("ngClass",U(29,oe,e.post().bookmarked,!e.post().bookmarked)),r(),h(" ",e.post().bookmarkcount," ")}}var V=class i{constructor(t){this.sanitizer=t}post=g.required();youtubeUrl=Y(()=>{if(this.post()){let t=/(?:https?:\/\/)?(?:www\.)?youtu(?:\.be\/|be.com\/\S*(?:watch|embed)(?:(?:(?=\/[-a-zA-Z0-9_]{11,}(?!\S))\/)|(?:\S*v=|v\/)))([-a-zA-Z0-9_]{11,})/,e=this.post().content.match(t);return e&&e[1]?this.sanitizer.bypassSecurityTrustResourceUrl(`https://www.youtube.com/embed/${e[1]}`):""}return""});baseUrl=M.baseUrl;showIframe=!1;likeClicked=y();repostClicked=y();bookmarkClicked=y();static \u0275fac=function(e){return new(e||i)(_(K))};static \u0275cmp=w({type:i,selectors:[["app-post"]],inputs:{post:[1,"post"]},outputs:{likeClicked:"likeClicked",repostClicked:"repostClicked",bookmarkClicked:"bookmarkClicked"},standalone:!0,features:[I],decls:1,vars:1,consts:[["alt","profile pic thumbnail",1,"profile-thumbnail",3,"src","routerLink"],[1,"post"],[3,"routerLink"],[1,"username",3,"routerLink"],[1,"date"],[1,"action"],[1,"bi","bi-chat","pointer"],[3,"click"],[1,"bi","pointer",3,"ngClass"],[1,"bi","bi-repeat","pointer",3,"ngClass"],[1,"bi","bi-bar-chart"],["frameborder","0","allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture","loading","lazy","allowfullscreen","",2,"width","98%","height","280px",3,"src"],["preload","none","controls","",3,"src"],["loading","lazy",3,"src"]],template:function(e,n){e&1&&C(0,de,35,32,"article"),e&2&&f(n.post()?0:-1)},dependencies:[Q,G,q],styles:["article[_ngcontent-%COMP%]{border:1px solid rgb(46,64,82);border-radius:8px;padding:8px;margin:8px 0;display:flex;gap:8px}.post[_ngcontent-%COMP%]{flex:1;min-width:0}span[_ngcontent-%COMP%]{font-weight:800}span.date[_ngcontent-%COMP%]{font-weight:100;font-size:12px}span.username[_ngcontent-%COMP%]{font-weight:100}p[_ngcontent-%COMP%]{color:#fff;word-wrap:break-word;white-space:pre-wrap}.action[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:24px 0 0;font-style:normal}.action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-style:normal;font-weight:100!important;margin-right:4px}section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], section[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{display:block;max-width:100%;margin:auto;border-radius:8px}.greenn[_ngcontent-%COMP%]{fill:green}.profile-thumbnail[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;object-fit:cover}"],changeDetection:0})};var D=class i{constructor(t,e){this.el=t;this.renderer=e}observer;ngAfterViewInit(){this.observer=new IntersectionObserver(([t])=>{t.isIntersecting&&(this.renderer.addClass(this.el.nativeElement,"visible"),this.observer?.disconnect())},{threshold:.1}),this.observer.observe(this.el.nativeElement)}ngOnDestroy(){this.observer?.disconnect()}static \u0275fac=function(e){return new(e||i)(_(A),_(R))};static \u0275dir=j({type:i,selectors:[["","appIntersect",""]],standalone:!0})};var me=(i,t)=>t.id;function ue(i,t){i&1&&(l(0,"div",1)(1,"div"),p(2,"|"),s()())}function _e(i,t){if(i&1){let e=v();l(0,"app-post",0),k("likeClicked",function(o){m(e);let b=a();return u(b.likeClicked(o))})("repostClicked",function(o){m(e);let b=a();return u(b.repostClicked(o))})("bookmarkClicked",function(o){m(e);let b=a();return u(b.bookmarkClicked(o))}),s(),C(1,ue,3,0,"div",1)}if(i&2){let e=t.$implicit,n=a();c("post",e),r(),f(n.showSeperator()?1:-1)}}var X=class i{constructor(t,e){this._authService=t;this._postService=e;Z(()=>{this.listMutable=this.list()})}list=g([]);listMutable;showSeperator=g();likeClicked(t){if(!this._authService.userdata()){alert("Login to continue");return}let e=this.listMutable.filter(n=>n.id==t)[0];this._postService.likePost(this._authService.userdata()?.id,e.id,e.UserId).subscribe({next:n=>{e.liked=!e.liked,e.liked?e.likecount++:e.likecount--,this.listMutable=this.listMutable.map(o=>o.id==e.id?P({},e):o)}})}repostClicked(t){if(!this._authService.userdata()){alert("Login to continue");return}let e=this.listMutable.filter(n=>n.id==t)[0];this._postService.Repost(this._authService.userdata()?.id,e.id,e.UserId).subscribe({next:n=>{e.reposted=!e.reposted,e.reposted?e.repostcount++:e.repostcount--,this.listMutable=this.listMutable.map(o=>o.id==e.id?P({},e):o)}})}bookmarkClicked(t){if(!this._authService.userdata()){alert("Login to continue");return}let e=this.listMutable.filter(n=>n.id==t)[0];this._postService.Bookmark(this._authService.userdata()?.id,e.id,e.UserId).subscribe({next:n=>{e.bookmarked=!e.bookmarked,e.bookmarked?e.bookmarkcount++:e.bookmarkcount--,this.listMutable=this.listMutable.map(o=>o.id==e.id?P({},e):o)}})}static \u0275fac=function(e){return new(e||i)(_(W),_(O))};static \u0275cmp=w({type:i,selectors:[["app-postlist"]],inputs:{list:[1,"list"],showSeperator:[1,"showSeperator"]},standalone:!0,features:[I],decls:2,vars:0,consts:[["appIntersect","",3,"likeClicked","repostClicked","bookmarkClicked","post"],[1,"seperator"]],template:function(e,n){e&1&&N(0,_e,2,2,null,null,me),e&2&&$(n.listMutable)},dependencies:[V,D],styles:[".seperator[_ngcontent-%COMP%]{display:flex;justify-content:center}"]})};export{O as a,X as b};
