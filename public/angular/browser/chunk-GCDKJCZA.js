import{a as v}from"./chunk-DQ3HOWQ2.js";import"./chunk-IHDMNEHU.js";import{a as B,b as E}from"./chunk-33Z2X7YL.js";import{Aa as I,B as s,C as d,Ca as R,G as u,H as l,Ha as A,J as c,M as r,N as a,O as p,P as g,Q as w,R as m,S as x,T as h,U as _,W as f,ba as S,da as T,g as P,o as C,s as y,t as b}from"./chunk-K4OJKT4O.js";var O=["emptydiv"],Q=t=>[t];function D(t,i){t&1&&p(0,"div",1)}function M(t,i){if(t&1&&p(0,"app-postlist",3),t&2){let e=m(2);l("list",e.post.ParentPosts)("showSeperator",!0)}}function k(t,i){if(t&1){let e=g();r(0,"app-textarea",7),w("sendText",function(n){y(e);let V=m(2);return b(V.add(n))}),a()}if(t&2){let e=m(2);l("disablePostButton",e.disablePostButton)}}function F(t,i){t&1&&(r(0,"p",5),f(1,"Login to post"),a())}function N(t,i){t&1&&p(0,"br")(1,"progress",8)}function q(t,i){if(t&1&&(r(0,"div",2),u(1,M,1,2,"app-postlist",3),p(2,"app-postlist",3),r(3,"div",null,0),f(5,"\xA0"),a(),u(6,k,1,1,"app-textarea",4)(7,F,2,0,"p",5)(8,N,2,0),r(9,"h6"),f(10,"Replies : "),a(),p(11,"app-postlist",6),a()),t&2){let e=m();s(),c(e.post.ParentPosts?1:-1),s(),l("list",T(6,Q,e.post))("showSeperator",!1),s(4),c(e._authservice.userdata()?6:7),s(2),c(e.showProgress?8:-1),s(3),l("list",e.post.ChildPosts)}}var j=class t{constructor(i,e,o,n){this.route=i;this._postservice=e;this._authservice=o;this.router=n}post;clearTextArea=0;emptydiv;data;disablePostButton=!1;loading=!1;showProgress=!1;textarea;ngOnInit(){this.loading=!0,this.route.params.pipe().subscribe({next:i=>{this.data={username:i.username,id:i.id},this.getPost()}})}getPost(){this._postservice.getPostById(this.data.username,this.data.id,this._authservice.userdata()?.id??null).pipe().subscribe({next:i=>{this.post=i,setTimeout(()=>this.emptydiv.nativeElement.scrollIntoView({behavior:"smooth"}),600),this.loading=!1},error:i=>{alert(i.error),this.loading=!1}})}add(i){(this._authservice.userdata()?.id??0)!=0&&(this.disablePostButton=!0,this.showProgress=!0,this._postservice.addNewPost({content:i.content,parentpostid:this.post.id,file:i.file}).pipe(P(1e3)).subscribe({next:o=>{this.getPost(),this.disablePostButton=!1,this._postservice.postSuccessSubject.next("success"),this.showProgress=!1,this.textarea.reset()},error:o=>{alert(o.error),this.disablePostButton=!1,this._postservice.postSuccessSubject.next("fail"),this.showProgress=!1}}))}static \u0275fac=function(e){return new(e||t)(d(I),d(B),d(A),d(R))};static \u0275cmp=C({type:t,selectors:[["app-postexpanded"]],viewQuery:function(e,o){if(e&1&&(x(O,5),x(v,5)),e&2){let n;h(n=_())&&(o.emptydiv=n.first),h(n=_())&&(o.textarea=n.first)}},standalone:!0,features:[S],decls:2,vars:1,consts:[["emptydiv",""],[1,"spinner","center-block"],[1,"container"],[3,"list","showSeperator"],["placeholderText","Post your reply",3,"disablePostButton"],[1,"text-area-p"],[3,"list"],["placeholderText","Post your reply",3,"sendText","disablePostButton"],["aria-busy","true"]],template:function(e,o){e&1&&u(0,D,1,0,"div",1)(1,q,12,8,"div",2),e&2&&c(o.loading?0:o.post?1:-1)},dependencies:[E,v],styles:["textarea[_ngcontent-%COMP%]{margin:8px 0;width:100%;font-size:16px;padding:8px;border-radius:8px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;resize:none}"]})};export{j as PostexpandedComponent};
