import{a as E}from"./chunk-7JLMQZJ5.js";import{a as B,b as R}from"./chunk-JNTCXE2R.js";import{$ as S,C as s,D as a,Da as A,H as m,I as r,K as u,N as p,O as d,P as l,Q as P,R as C,S as c,T as b,U as y,V as g,X as f,ba as T,g as x,p as _,t as v,u as h,wa as w,ya as I}from"./chunk-FOPQGPOM.js";var O=["emptydiv"],D=i=>[i];function M(i,t){i&1&&l(0,"div",1)}function Q(i,t){if(i&1&&l(0,"app-postlist",3),i&2){let e=c(2);r("list",e.post.ParentPosts)("showSeperator",!0)}}function k(i,t){if(i&1){let e=P();p(0,"app-textarea",7),C("sendText",function(n){v(e);let V=c(2);return h(V.add(n))}),d()}if(i&2){let e=c(2);r("disablePostButton",e.disablePostButton)}}function F(i,t){i&1&&(p(0,"p",5),f(1,"Login to post"),d())}function N(i,t){if(i&1&&(p(0,"div",2),m(1,Q,1,2,"app-postlist",3),l(2,"app-postlist",3),p(3,"div",null,0),f(5,"\xA0"),d(),m(6,k,1,1,"app-textarea",4)(7,F,2,0,"p",5),l(8,"app-postlist",6),d()),i&2){let e=c();s(),u(e.post.ParentPosts?1:-1),s(),r("list",T(5,D,e.post))("showSeperator",!1),s(4),u(e._authservice.userdata()?6:7),s(2),r("list",e.post.ChildPosts)}}var j=class i{constructor(t,e,o,n){this.route=t;this._postservice=e;this._authservice=o;this.router=n}post;clearTextArea=0;emptydiv;data;disablePostButton=!1;loading=!1;ngOnInit(){this.loading=!0,this.route.params.pipe().subscribe({next:t=>{this.data={username:t.username,id:t.id},this.getPost()}})}getPost(){this._postservice.getUserPostById(this.data.username,this.data.id,this._authservice.userdata()?.id??null).pipe().subscribe({next:t=>{this.post=t,setTimeout(()=>this.emptydiv.nativeElement.scrollIntoView({behavior:"smooth"}),600),this.loading=!1},error:t=>{alert(t.error),this.loading=!1}})}add(t){(this._authservice.userdata()?.id??0)!=0&&(this.disablePostButton=!0,this._postservice.addNewPost({content:t.content,parentpostid:this.post.id,file:t.file}).pipe(x(1e3)).subscribe({next:o=>{this.getPost(),this.disablePostButton=!1,this._postservice.postSuccessSubject.next("success")},error:o=>{alert(o.error),this.disablePostButton=!1,this._postservice.postSuccessSubject.next("fail")}}))}static \u0275fac=function(e){return new(e||i)(a(w),a(B),a(A),a(I))};static \u0275cmp=_({type:i,selectors:[["app-postexpanded"]],viewQuery:function(e,o){if(e&1&&b(O,5),e&2){let n;y(n=g())&&(o.emptydiv=n.first)}},standalone:!0,features:[S],decls:2,vars:1,consts:[["emptydiv",""],[1,"spinner","center-block"],[1,"container"],[3,"list","showSeperator"],["placeholderText","Post your reply",3,"disablePostButton"],[1,"text-area-p"],[3,"list"],["placeholderText","Post your reply",3,"sendText","disablePostButton"]],template:function(e,o){e&1&&m(0,M,1,0,"div",1)(1,N,9,7,"div",2),e&2&&u(o.loading?0:o.post?1:-1)},dependencies:[R,E],styles:["textarea[_ngcontent-%COMP%]{margin:8px 0;width:100%;font-size:16px;padding:8px;border-radius:2px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;resize:none}"]})};export{j as PostexpandedComponent};
