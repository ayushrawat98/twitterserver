import{a as y}from"./chunk-GYFRJGPP.js";import{a as C,b as w}from"./chunk-MZ7H3CGF.js";import{B as s,Ba as x,C as l,G as h,H as r,J as _,M as n,N as a,O as v,P as S,Q as p,R as m,W as c,_ as P,p as u,pa as g,t as b,u as f}from"./chunk-MLTJO6UL.js";function T(o,t){if(o&1){let e=S();n(0,"app-textarea",6),p("sendText",function(d){b(e);let N=m();return f(N.add(d))}),a()}if(o&2){let e=m();r("disablePostButton",e.disablePostButton)}}function O(o,t){o&1&&(n(0,"p",2),c(1,"Login to post"),a())}var M=class o{constructor(t,e,i){this._postService=t;this._authService=e;this.viewportScroller=i}allPosts=[];pageNumber=0;loadMoreDisabled=!1;disablePostButton=!1;ngOnInit(){this.getAllPosts()}getAllPosts(){this._postService.getAllPosts(this._authService.userdata()?.id??null,this.pageNumber).subscribe({next:t=>{t.length==0&&this.pageNumber!=0?(this.pageNumber--,this.loadMoreDisabled=!0):(this.loadMoreDisabled=!1,this.allPosts=t,this.viewportScroller.scrollToPosition([0,0]))}})}add(t){this.disablePostButton=!0,this._postService.addNewPost({content:t.content,parentpostid:null,file:t.file}).pipe().subscribe({next:e=>{this.pageNumber=0,this.getAllPosts(),this.disablePostButton=!1,this._postService.postSuccessSubject.next("success")},error:e=>{alert(e.error),this.disablePostButton=!1,this._postService.postSuccessSubject.next("fail")}})}loadNew(){this.pageNumber--,this.getAllPosts()}loadOld(){this.pageNumber++,this.getAllPosts()}ngOnDestroy(){}static \u0275fac=function(e){return new(e||o)(l(C),l(x),l(g))};static \u0275cmp=u({type:o,selectors:[["app-main"]],standalone:!0,features:[P],decls:9,vars:5,consts:[[1,"container"],["placeholderText","What is happening?",3,"disablePostButton"],[1,"text-area-p"],[3,"list","showSeperator"],[2,"display","flex","justify-content","space-between"],[3,"click","disabled"],["placeholderText","What is happening?",3,"sendText","disablePostButton"]],template:function(e,i){e&1&&(n(0,"div",0),h(1,T,1,1,"app-textarea",1)(2,O,2,0,"p",2),v(3,"app-postlist",3),n(4,"div",4)(5,"button",5),p("click",function(){return i.loadNew()}),c(6,"Load New"),a(),n(7,"button",5),p("click",function(){return i.loadOld()}),c(8,"Load Older"),a()()()),e&2&&(s(),_(i._authService.userdata()?1:2),s(2),r("list",i.allPosts)("showSeperator",!1),s(2),r("disabled",i.pageNumber==0),s(2),r("disabled",i.loadMoreDisabled))},dependencies:[w,y],styles:["button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:auto}"]})};export{M as MainComponent};
