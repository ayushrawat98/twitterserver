import{A as T,Aa as M,B as r,Ba as R,C as F,G as _,H as c,J as k,K as D,L as j,M as p,N as s,O as u,P as S,Q as b,R as l,W as a,X as h,Y as C,_ as y,a as x,ba as w,c as V,da as A,fa as L,k as E,ka as N,ma as $,n as O,oa as z,p as v,qa as B,t as d,u as m,x as P,xa as H,y as g}from"./chunk-MLTJO6UL.js";var U=class i{constructor(e){this.http=e}postSuccessSubject=new V;baseUrl=M.baseUrl;getAllPosts(e,t){return this.http.post(this.baseUrl+"/api/post/"+t,{id:e})}getAllUserPosts(e,t){return this.http.post(`${this.baseUrl}/api/${e}/post`,{id:t})}getUserPostById(e,t,n){return this.http.post(`${this.baseUrl}/api/${e}/post/${t}`,{id:n})}addNewPost(e){let t=new FormData;return t.append("content",e.content),t.append("parentpostid",e.parentpostid?.toString()??""),e.file&&t.append("file",e.file),this.http.post(this.baseUrl+"/api/post",t)}likePost(e,t,n){return this.http.post(this.baseUrl+"/api/post/like",{userid:e,postid:t,receiverid:n})}Repost(e,t,n){return this.http.post(this.baseUrl+"/api/post/repost",{userid:e,postid:t,receiverid:n})}Bookmark(e,t,n){return this.http.post(this.baseUrl+"/api/post/bookmark",{userid:e,postid:t,receiverid:n})}static \u0275fac=function(t){return new(t||i)(O(B))};static \u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"})};var K=(i,e)=>({"bi-heart-fill red":i,"bi-heart":e}),Q=(i,e)=>({green:i,"":e}),W=(i,e)=>({"bi-bookmark-fill blue":i,"bi-bookmark":e});function X(i,e){if(i&1&&u(0,"video",9),i&2){let t=l(3);c("src",t.baseUrl+"/"+t.post().media,T)}}function Z(i,e){if(i&1&&u(0,"img",10),i&2){let t=l(3);c("src",t.baseUrl+"/"+t.post().media,T)}}function tt(i,e){if(i&1&&_(0,X,1,1,"video",9)(1,Z,1,1,"img",10),i&2){let t=l(2);k(t.post().mediatype=="video/mp4"||t.post().mediatype=="video/webm"?0:1)}}function et(i,e){if(i&1){let t=S();p(0,"article")(1,"header")(2,"span"),a(3),s(),a(4," \xA0 "),p(5,"span",0),a(6),s(),a(7," \xA0 "),p(8,"span",1),a(9),A(10,"date"),s()(),p(11,"section",2)(12,"p"),a(13),s(),_(14,tt,2,1),s(),p(15,"footer",3)(16,"div",2),u(17,"i",4),a(18),s(),p(19,"div",5),b("click",function(){d(t);let o=l();return m(o.likeClicked.emit(o.post().id))}),u(20,"i",6),a(21),s(),p(22,"div",5),b("click",function(){d(t);let o=l();return m(o.repostClicked.emit(o.post().id))}),u(23,"i",7),a(24),s(),p(25,"div"),u(26,"i",8),a(27),s(),p(28,"div",5),b("click",function(){d(t);let o=l();return m(o.bookmarkClicked.emit(o.post().id))}),u(29,"i",6),a(30),s()()()}if(i&2){let t=l();r(3),h(t.post().User.displayname),r(3),h("@"+t.post().User.username),r(3),h(L(10,15,t.post().createdAt,"d/M/YY, h:mm a")),r(2),c("routerLink","/"+t.post().User.username+"/post/"+t.post().id),r(2),h(t.post().content),r(),k(t.post().media?14:-1),r(2),c("routerLink","/"+t.post().User.username+"/post/"+t.post().id),r(2),C(" ",t.post().commentcount," "),r(2),c("ngClass",w(18,K,t.post().liked,!t.post().liked)),r(),C(" ",t.post().likecount," "),r(2),c("ngClass",w(21,Q,t.post().reposted,!t.post().reposted)),r(),C(" ",t.post().repostcount," "),r(3),C(" ",t.post().views," "),r(2),c("ngClass",w(24,W,t.post().bookmarked,!t.post().bookmarked)),r(),C(" ",t.post().bookmarkcount," ")}}var I=class i{post=g.required();baseUrl=M.baseUrl;likeClicked=P();repostClicked=P();bookmarkClicked=P();static \u0275fac=function(t){return new(t||i)};static \u0275cmp=v({type:i,selectors:[["app-post"]],inputs:{post:[1,"post"]},outputs:{likeClicked:"likeClicked",repostClicked:"repostClicked",bookmarkClicked:"bookmarkClicked"},standalone:!0,features:[y],decls:1,vars:1,consts:[[1,"username"],[1,"date"],[3,"routerLink"],[1,"action"],[1,"bi","bi-chat","pointer"],[3,"click"],[1,"bi","pointer",3,"ngClass"],[1,"bi","bi-repeat","pointer",3,"ngClass"],[1,"bi","bi-bar-chart"],["preload","none","controls","",3,"src"],["loading","lazy",3,"src"]],template:function(t,n){t&1&&_(0,et,31,27,"article"),t&2&&k(n.post()?0:-1)},dependencies:[H,z,$],styles:["article[_ngcontent-%COMP%]{border:1px solid rgb(46,64,82);border-radius:2px;padding:8px;margin:8px 0}span[_ngcontent-%COMP%]{font-weight:800}span.date[_ngcontent-%COMP%]{font-weight:100;font-size:12px}span.username[_ngcontent-%COMP%]{font-weight:100}p[_ngcontent-%COMP%]{color:#fff;word-wrap:break-word;white-space:pre-wrap}.action[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:24px 0 0;font-style:normal}.action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-style:normal;font-weight:100!important;margin-right:4px}img[_ngcontent-%COMP%], video[_ngcontent-%COMP%]{display:block;max-width:80%;margin:auto}.greenn[_ngcontent-%COMP%]{fill:green}"],changeDetection:0})};var it=(i,e)=>e.id;function nt(i,e){i&1&&(p(0,"div",1)(1,"div"),a(2,"|"),s()())}function ot(i,e){if(i&1){let t=S();p(0,"app-post",0),b("likeClicked",function(o){d(t);let f=l();return m(f.likeClicked(o))})("repostClicked",function(o){d(t);let f=l();return m(f.repostClicked(o))})("bookmarkClicked",function(o){d(t);let f=l();return m(f.bookmarkClicked(o))}),s(),_(1,nt,3,0,"div",1)}if(i&2){let t=e.$implicit,n=l();c("post",t),r(),k(n.showSeperator()?1:-1)}}var q=class i{constructor(e,t){this._authService=e;this._postService=t;N(()=>{this.listMutable=this.list()})}list=g([]);listMutable;showSeperator=g();likeClicked(e){if(!this._authService.userdata()){alert("Login to continue");return}let t=this.listMutable.filter(n=>n.id==e)[0];this._postService.likePost(this._authService.userdata()?.id,t.id,t.UserId).subscribe({next:n=>{t.liked=!t.liked,t.liked?t.likecount++:t.likecount--,this.listMutable=this.listMutable.map(o=>o.id==t.id?x({},t):o)}})}repostClicked(e){debugger;if(!this._authService.userdata()){alert("Login to continue");return}let t=this.listMutable.filter(n=>n.id==e)[0];this._postService.Repost(this._authService.userdata()?.id,t.id,t.UserId).subscribe({next:n=>{t.reposted=!t.reposted,t.reposted?t.repostcount++:t.repostcount--,this.listMutable=this.listMutable.map(o=>o.id==t.id?x({},t):o)}})}bookmarkClicked(e){if(!this._authService.userdata()){alert("Login to continue");return}let t=this.listMutable.filter(n=>n.id==e)[0];this._postService.Bookmark(this._authService.userdata()?.id,t.id,t.UserId).subscribe({next:n=>{t.bookmarked=!t.bookmarked,t.bookmarked?t.bookmarkcount++:t.bookmarkcount--,this.listMutable=this.listMutable.map(o=>o.id==t.id?x({},t):o)}})}static \u0275fac=function(t){return new(t||i)(F(R),F(U))};static \u0275cmp=v({type:i,selectors:[["app-postlist"]],inputs:{list:[1,"list"],showSeperator:[1,"showSeperator"]},standalone:!0,features:[y],decls:2,vars:0,consts:[[3,"likeClicked","repostClicked","bookmarkClicked","post"],[1,"seperator"]],template:function(t,n){t&1&&D(0,ot,2,2,null,null,it),t&2&&j(n.listMutable)},dependencies:[I],styles:[".seperator[_ngcontent-%COMP%]{display:flex;justify-content:center}"]})};export{U as a,q as b};
